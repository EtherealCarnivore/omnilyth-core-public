import{r as i,c as N,j as e}from"./index-BlQCsTae.js";function b({pattern:r,toolId:g,toolLabel:c,defaultName:h}){const[p,d]=i.useState(!1),[o,m]=i.useState(""),[l,s]=i.useState(null),[u,t]=i.useState(""),{add:f,exists:j,storageInfo:a}=N(),v=()=>{if(!r||r.trim()===""){t("No pattern to save"),s("error");return}const n=new Date().toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1}),y=h||`${c} - ${n}`;m(y),s(null),t(""),d(!0)},w=async()=>{if(!o.trim()){t("Pattern name is required"),s("error");return}if(o.length>50){t("Pattern name must be 50 characters or less"),s("error");return}if(j(r)){t("This pattern is already saved"),s("error");return}a.nearLimit&&t(`Storage almost full (${a.percentUsed}%). Consider deleting old patterns.`);const n=await f({name:o.trim(),pattern:r.trim(),tool:g,toolLabel:c});n.success?(s("success"),setTimeout(()=>{d(!1),s(null)},1500)):(s("error"),t(n.message||"Failed to save pattern"))},x=()=>{d(!1),s(null),t("")};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:v,className:`glass-card px-4 py-2 rounded-lg flex items-center gap-2 hover:bg-poe-gold/10
                   transition-colors focus:outline-none focus:ring-2 focus:ring-poe-gold/50`,style:{minHeight:"44px"},"aria-label":"Save regex pattern",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]}),e.jsx("span",{className:"font-medium",children:"Save Pattern"})]}),p&&e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:x,children:e.jsxs("div",{className:"glass-card rounded-xl p-6 max-w-md w-full space-y-4",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-poe-gold",children:"Save Regex Pattern"}),e.jsx("button",{onClick:x,className:"text-zinc-400 hover:text-white transition-colors p-1","aria-label":"Close modal",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6",children:[e.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),e.jsxs("div",{className:"text-sm text-zinc-400",children:["Tool: ",e.jsx("span",{className:"text-white font-medium",children:c})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm text-zinc-400",children:"Pattern:"}),e.jsx("div",{className:`bg-zinc-900/50 border border-zinc-800 rounded-lg p-3 text-sm font-mono
                            text-white overflow-x-auto`,children:r})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"pattern-name",className:"text-sm text-zinc-400",children:["Pattern Name: ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{id:"pattern-name",type:"text",value:o,onChange:n=>m(n.target.value),maxLength:50,className:`w-full bg-zinc-900/50 border border-zinc-800 rounded-lg px-4 py-2 text-white
                         focus:outline-none focus:ring-2 focus:ring-poe-gold/50 focus:border-poe-gold`,style:{minHeight:"44px",fontSize:"max(16px, 1rem)"},placeholder:"Enter a name for this pattern",autoFocus:!0}),e.jsxs("div",{className:"text-xs text-zinc-500 text-right",children:[o.length,"/50 characters"]})]}),l==="success"&&e.jsxs("div",{className:"flex items-center gap-2 text-green-500 bg-green-500/10 rounded-lg p-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 flex-shrink-0",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),e.jsx("span",{className:"font-medium",children:"Pattern saved successfully!"})]}),l==="error"&&u&&e.jsxs("div",{className:"flex items-start gap-2 text-red-500 bg-red-500/10 rounded-lg p-3",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 flex-shrink-0 mt-0.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),e.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),e.jsx("span",{className:"text-sm",children:u})]}),a.nearLimit&&l!=="error"&&e.jsxs("div",{className:"flex items-start gap-2 text-yellow-500 bg-yellow-500/10 rounded-lg p-3 text-sm",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5 flex-shrink-0 mt-0.5",children:[e.jsx("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),e.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),e.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),e.jsxs("span",{children:["Storage ",a.percentUsed,"% full. ~",a.estimatedSlotsRemaining," patterns remaining."]})]}),l!=="success"&&e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{onClick:x,className:`flex-1 glass-card px-4 py-2 rounded-lg hover:bg-zinc-700/30 transition-colors
                           focus:outline-none focus:ring-2 focus:ring-zinc-500/50`,style:{minHeight:"44px"},children:"Cancel"}),e.jsx("button",{onClick:w,className:`flex-1 bg-poe-gold hover:bg-poe-gold-bright text-zinc-950 font-bold px-4 py-2
                           rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-poe-gold/50`,style:{minHeight:"44px"},children:"Save Pattern"})]})]})})]})}export{b as S};
