import{r as u,j as e,u as f}from"./index-o8EIvGVU.js";import{P as w}from"./PriceDisclaimer-ErTpwtG3.js";const C=[0,0,1,3,10,60,300],k=[0,1,1,3,10,70,350],z=[0,1,1,2,25,35,50],v={2:[1,2,3,5],3:[1,2,3,5,8,10],4:[2,5,10,15,20,30],5:[10,20,30,50,75,100,150],6:[50,100,150,200,250,300,400,500,750,1e3]};function M(l,c){const o=Math.max(0,Math.min(30,l)),r=Math.max(2,Math.min(6,c)),s=C[r]/(1+o/100),n=1/s,i=Math.sqrt((1-n)/(n*n)),a=(v[r]||v[6]).map(m=>({jewellers:m,probability:1-Math.pow(1-n,m)}));return{quality:o,targetSockets:r,successChance:n,avgJewellers:s,stdDev:i,benchCost:k[r],minItemLevel:z[r],cumulativeTable:a}}function S(l,c,o,r){const d=[];if(r){const n=l.benchCost,i=c?n*c+(o?n*o:0):null;d.push({method:"Corrupted Bench",description:`${n} jewellers + ${n} vaal orbs`,avgOrbs:n,extraOrbs:`+ ${n} vaals`,chaosCost:i})}else{const n=l.successChance>0?Math.ceil(Math.log(.25)/Math.log(1-l.successChance)):1/0;d.push({method:"Manual (Jeweller's)",description:`~${Math.round(l.avgJewellers)} jewellers at ${l.quality}% quality`,avgOrbs:l.avgJewellers,p75Orbs:n,chaosCost:c?l.avgJewellers*c:null,riskAdjustedCost:c?n*c:null}),d.push({method:"Crafting Bench",description:`Guaranteed ${l.targetSockets} sockets`,avgOrbs:l.benchCost,chaosCost:c?l.benchCost*c:null,riskAdjustedCost:c?l.benchCost*c:null})}const s=d.filter(n=>n.chaosCost!=null);if(s.length>0){const n=s.some(x=>x.riskAdjustedCost!=null)?"riskAdjustedCost":"chaosCost",i=s.filter(x=>x[n]!=null);if(i.length>0){const x=Math.min(...i.map(a=>a[n]));for(const a of d)a.isBest=a[n]===x}}return d}function $({prices:l}){const[c,o]=u.useState(20),[r,d]=u.useState(6),[s,n]=u.useState(!1),[i,x]=u.useState(""),a=u.useMemo(()=>M(s?0:c,r),[c,r,s]),m=i===""?null:parseInt(i,10),p=!s&&m>0?1-Math.pow(1-a.successChance,m):null,b=l?.["jewellers-orb"]?.chaosRate,g=l?.["vaal-orb"]?.chaosRate??null,j=b!=null,N=u.useMemo(()=>j?S(a,b,g,s):null,[a,b,g,j,s]);function y(t){const h=parseInt(t,10);if(t===""){o(0);return}isNaN(h)||o(Math.max(0,Math.min(30,h)))}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-cyan-300",children:"Socketing Calculator"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Calculate Jeweller's Orbs needed to reach a target socket count."})]}),e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer select-none group w-fit",children:[e.jsxs("span",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:t=>n(t.target.checked),className:"sr-only peer"}),e.jsx("span",{className:`
            block w-10 h-6 rounded-full transition-colors duration-200
            ${s?"bg-red-600":"bg-zinc-800/60"}
          `}),e.jsx("span",{className:`
            absolute left-0.5 top-0.5 w-5 h-5 rounded-full bg-white shadow transition-transform duration-200
            ${s?"translate-x-4":"translate-x-0"}
          `})]}),e.jsx("span",{className:`text-sm font-medium transition-colors duration-200 ${s?"text-red-400":"text-zinc-400 group-hover:text-zinc-100"}`,children:"Corrupted Item"}),s&&e.jsx("span",{className:"text-[10px] uppercase tracking-wider text-red-400/60 font-semibold",children:"Bench only"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{className:`rounded-xl bg-zinc-900/40 border border-white/5 p-4 space-y-4 ${s?"opacity-40 pointer-events-none":""}`,children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-xs uppercase tracking-wider text-zinc-400",children:"Item Quality"}),s&&e.jsx("p",{className:"text-[10px] text-red-400/70",children:"Quality has no effect on corrupted bench crafts"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:0,max:30,value:s?0:c,onChange:t=>y(t.target.value),disabled:s,className:"calc-input w-20 text-center text-lg font-semibold"}),e.jsx("span",{className:"text-zinc-400 text-sm",children:"%"})]}),e.jsx("input",{type:"range",min:0,max:30,value:s?0:c,onChange:t=>o(Number(t.target.value)),disabled:s,className:"fusing-range w-full"}),e.jsxs("div",{className:"flex justify-between text-[10px] text-zinc-400/60 px-0.5",children:[e.jsx("span",{children:"0%"}),e.jsx("span",{children:"30%"})]})]})}),e.jsxs("div",{className:"rounded-xl bg-zinc-900/40 border border-white/5 p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wider text-cyan-300/70",children:"Target Sockets"}),e.jsx("div",{className:"flex items-center gap-2 flex-wrap",children:[2,3,4,5,6].map(t=>e.jsxs("button",{onClick:()=>d(t),className:`
                    px-4 py-2 rounded-lg text-sm font-semibold transition-all duration-200 border
                    ${r===t?"bg-cyan-900/40 border-cyan-700/50 text-cyan-300":"bg-zinc-900/40 border-white/5 text-zinc-400 hover:text-zinc-100 hover:border-white/[0.08]"}
                  `,children:[t,"S"]},t))}),a.minItemLevel>1&&e.jsxs("p",{className:"text-[10px] text-zinc-400/60",children:["Requires item level ",a.minItemLevel,"+"]})]}),!s&&e.jsxs("div",{className:"border-t border-white/5 pt-3 space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wider text-zinc-400",children:"Jeweller's to use"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:1,placeholder:"e.g. 200",value:i,onChange:t=>x(t.target.value),className:"calc-input w-28 text-center"}),p!=null&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-zinc-400 text-sm",children:"→"}),e.jsxs("span",{className:"text-cyan-300 font-bold text-lg",children:[(p*100).toFixed(1),"%"]})]})]}),p!=null&&e.jsxs("p",{className:"text-xs text-zinc-400",children:["chance to hit ",r,"S within ",m.toLocaleString()," jewellers"]})]}),s&&e.jsxs("div",{className:"border-t border-red-800/15 pt-3 space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-wider text-red-300/70",children:"Corrupted Bench"}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[e.jsxs("strong",{className:"text-red-300",children:[a.benchCost," jewellers + ",a.benchCost," vaal orbs"]})," for guaranteed ",r," sockets."]})]})]})]}),e.jsxs("div",{className:`grid grid-cols-1 ${s?"sm:grid-cols-2":"sm:grid-cols-3"} gap-3`,children:[!s&&e.jsxs("div",{className:"rounded-xl bg-cyan-900/20 border border-cyan-800/30 p-4 text-center",children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-cyan-300/70 mb-1",children:"Success Chance"}),e.jsxs("div",{className:"text-2xl font-bold text-cyan-300",children:[(a.successChance*100).toFixed(2),"%"]}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:"per jeweller use"})]}),e.jsxs("div",{className:`rounded-xl p-4 text-center ${s?"bg-red-900/20 border border-red-800/30":"bg-cyan-900/20 border border-cyan-800/30"}`,children:[e.jsx("div",{className:`text-xs uppercase tracking-wider mb-1 ${s?"text-red-300/70":"text-cyan-300/70"}`,children:s?"Corrupted Bench":"Avg Jeweller's"}),e.jsx("div",{className:`text-2xl font-bold ${s?"text-red-300":"text-cyan-300"}`,children:s?a.benchCost:Math.round(a.avgJewellers).toLocaleString()}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:s?`jewellers + ${a.benchCost} vaals`:e.jsxs(e.Fragment,{children:["at ",a.quality,"% quality · bench: ",a.benchCost]})})]}),e.jsxs("div",{className:`rounded-xl p-4 text-center ${s?"bg-red-900/20 border border-red-800/30":"bg-cyan-900/20 border border-cyan-800/30"}`,children:[e.jsx("div",{className:`text-xs uppercase tracking-wider mb-1 ${s?"text-red-300/70":"text-cyan-300/70"}`,children:!s&&a.avgJewellers<a.benchCost?"Manual is cheaper!":"Bench Cost"}),e.jsx("div",{className:`text-2xl font-bold ${!s&&a.avgJewellers<a.benchCost?"text-green-300":s?"text-red-300":"text-cyan-300"}`,children:s?a.benchCost:`${Math.round(a.benchCost-a.avgJewellers)}`}),e.jsx("div",{className:"text-xs text-zinc-400 mt-1",children:s?`guaranteed ${r} sockets`:"jewellers saved vs bench"})]})]}),N&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-100 mb-3",children:"Cost Comparison"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"text-left px-4 py-2 text-zinc-400 font-medium",children:"Method"}),e.jsx("th",{className:"text-right px-4 py-2 text-zinc-400 font-medium",children:"Avg Orbs"}),e.jsx("th",{className:"text-right px-4 py-2 text-zinc-400 font-medium",children:"Chaos Cost"})]})}),e.jsx("tbody",{children:N.map((t,h)=>e.jsxs("tr",{className:t.isBest?"bg-green-900/30 text-green-300":h%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsxs("span",{className:t.isBest?"font-semibold":"",children:[t.method,t.isBest&&e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(Best)"})]})}),e.jsxs("td",{className:"text-right px-4 py-2 font-mono",children:[e.jsx("span",{children:t.avgOrbs<10?t.avgOrbs.toFixed(1):Math.round(t.avgOrbs).toLocaleString()}),t.extraOrbs&&e.jsx("span",{className:"text-red-400/70 text-xs ml-1",children:t.extraOrbs})]}),e.jsx("td",{className:"text-right px-4 py-2 font-mono",children:t.chaosCost!=null?`${Math.round(t.chaosCost).toLocaleString()}c`:"—"})]},t.method))})]})}),s&&!g&&e.jsx("p",{className:"text-xs text-red-400/60 mt-2",children:"Vaal Orb price not available — bench cost may be underestimated."})]}),!s&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-100 mb-3",children:"Cumulative Probability"}),e.jsxs("p",{className:"text-xs text-zinc-400 mb-2",children:["Chance of hitting ",r," sockets within N jewellers at ",c,"% quality"]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"text-left px-4 py-2 text-zinc-400 font-medium",children:"Jeweller's"}),e.jsx("th",{className:"text-right px-4 py-2 text-zinc-400 font-medium",children:"Probability"}),e.jsx("th",{className:"text-left px-4 py-2 text-zinc-400 font-medium",children:"Visual"})]})}),e.jsx("tbody",{children:a.cumulativeTable.map((t,h)=>e.jsxs("tr",{className:h%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsx("td",{className:"px-4 py-2 font-mono",children:t.jewellers.toLocaleString()}),e.jsxs("td",{className:"text-right px-4 py-2 font-mono text-cyan-300",children:[(t.probability*100).toFixed(1),"%"]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("div",{className:"w-full bg-zinc-950/60 rounded-full h-2",children:e.jsx("div",{className:"bg-cyan-500 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,t.probability*100)}%`}})})})]},t.jewellers))})]})})]}),!s&&r===6&&e.jsxs("div",{className:"rounded-xl bg-zinc-900/60 border border-white/5 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-100 mb-2",children:"Quality Quick Reference"}),e.jsxs("p",{className:"text-xs text-zinc-400 mb-3",children:["Average Jeweller's Orbs for 6 sockets at various quality levels. Quality is ",e.jsx("strong",{className:"text-cyan-300",children:"not consumed"})," when using Jeweller's Orbs."]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-xs",children:[0,10,20,30].map(t=>{const h=300/(1+t/100);return e.jsxs("div",{className:`rounded-lg p-2 text-center border ${c===t?"bg-cyan-900/30 border-cyan-700/40 text-cyan-300":"bg-zinc-900/40 border-white/5 text-zinc-400"}`,children:[e.jsxs("div",{className:"font-semibold",children:[t,"%"]}),e.jsx("div",{className:"text-lg font-bold",children:Math.round(h)}),e.jsx("div",{className:"text-[10px] opacity-70",children:"avg jewellers"})]},t)})})]}),e.jsxs("div",{className:"rounded-xl bg-cyan-900/10 border border-cyan-800/20 p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-cyan-300 mb-2",children:"Jeweller's Orb Mechanics"}),e.jsxs("ul",{className:"text-sm text-zinc-400 space-y-1",children:[e.jsx("li",{children:"• Items always start at 1 socket"}),e.jsx("li",{children:"• Quality improves odds by 1% per 1% quality (linear)"}),e.jsxs("li",{children:["• Quality is ",e.jsx("strong",{className:"text-cyan-300",children:"not consumed"})," — apply Armourer's Scraps/Whetstones first"]}),e.jsx("li",{children:"• 6 sockets require item level 50+"}),e.jsx("li",{children:"• At 0% quality, manual rolling (avg 300) beats the bench (350) for 6S"})]})]})]})}function A(){const{prices:l}=f();return e.jsxs("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:[e.jsx(w,{}),e.jsx($,{prices:l})]})}export{A as default};
