import{r as I,j as e,u as D}from"./index-StS4Kiu4.js";import{g as z}from"./colorChances-BUcH6GNe.js";import{a as K}from"./mathUtils-DBoKL8H6.js";const P={1:.5,2:.25,3:.25};function S(d,t,w,a,l,g,o,b){const u=z(t,w,a);let n=0;for(let r=1;r<=3;r++){if(r>d||r<b)continue;const p=d-r;if(p<l+g+o)continue;const m=K(p,l,g,o,u.r,u.g,u.b);n+=P[r]*m}const j=n>0?1/n:1/0,c=n>0?Math.sqrt((1-n)/(n*n)):1/0;return{chance:n,avgAttempts:j,stdDev:c}}function B({prices:d}){const[t,w]=I.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:"",white:""}),[a,l]=I.useState(null),[g,o]=I.useState(""),b=d?.["chromatic-orb"]?.chaosRate,u=d?.["omen-of-blanching"]?.chaosValue,n=(b||0)+(u||0),j=b&&u;function c(s,k){w(C=>({...C,[s]:k}))}function r(){const s=t.str===""?0:parseInt(t.str,10),k=t.dex===""?0:parseInt(t.dex,10),C=t.int===""?0:parseInt(t.int,10),f=t.red===""?0:parseInt(t.red,10),N=t.green===""?0:parseInt(t.green,10),y=t.blue===""?0:parseInt(t.blue,10),h=t.white===""?0:parseInt(t.white,10);let x=t.sockets===""?null:parseInt(t.sockets,10);if(x===null){const v=f+N+y+h;v>0&&v<=6&&(x=v,c("sockets",String(v)))}if(!x||x<1||x>6){o("Total sockets must be between 1 and 6."),l(null);return}if(f<0||N<0||y<0||h<0){o("Desired colors must be non-negative."),l(null);return}if(h<1){o("White sockets (W) must be at least 1 for Omen of Blanching."),l(null);return}if(f+N+y+h>x){o(`Desired colors (${f+N+y+h}) exceed total sockets (${x}).`),l(null);return}o(""),l(S(x,s,k,C,f,N,y,h))}const p=t.sockets===""?null:parseInt(t.sockets,10),m=t.sockets!==""&&(isNaN(p)||p<1||p>6);function i(s){s.key==="Enter"&&!m&&r()}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-zinc-100 flex items-center justify-center gap-3",children:[e.jsx("img",{src:"/omnilyth-core-public/Omen_of_Blanching.png",alt:"",className:"w-8 h-8"}),"Omen of Blanching Calculator"]}),e.jsxs("p",{className:"text-sm text-zinc-400",children:["Uses a normal Chromatic Orb (stat requirements affect colors), then turns ",e.jsx("strong",{className:"text-zinc-100",children:"1â€“3"})," random sockets white (",e.jsx("strong",{className:"text-zinc-100",children:"50% / 25% / 25%"}),")."]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"sm:col-span-4 max-w-[120px] mx-auto space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:t.sockets,onChange:s=>c("sockets",s.target.value),onKeyDown:i,className:"calc-input w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"STR"}),e.jsx("input",{type:"number",placeholder:"str",value:t.str,onChange:s=>c("str",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"DEX"}),e.jsx("input",{type:"number",placeholder:"dex",value:t.dex,onChange:s=>c("dex",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"INT"}),e.jsx("input",{type:"number",placeholder:"int",value:t.int,onChange:s=>c("int",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]}),e.jsx("div",{}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"Red"}),e.jsx("input",{type:"number",placeholder:"R",value:t.red,onChange:s=>c("red",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"Green"}),e.jsx("input",{type:"number",placeholder:"G",value:t.green,onChange:s=>c("green",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"Blue"}),e.jsx("input",{type:"number",placeholder:"B",value:t.blue,onChange:s=>c("blue",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-gray-300",children:"White"}),e.jsx("input",{type:"number",placeholder:"W",value:t.white,onChange:s=>c("white",s.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-white-socket border-gray-500 focus:ring-gray-400/40"})]})]}),m&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 1 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:r,disabled:m,className:"calc-button bg-zinc-800/60 hover:bg-zinc-800/60 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),g&&!m&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:g}),a&&e.jsx("div",{className:"overflow-x-auto",children:a.chance===0?e.jsx("p",{className:"text-center text-red-400",children:"Impossible with these parameters."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-zinc-400 text-xs uppercase tracking-wider",children:[e.jsx("th",{className:"px-4 py-2 text-center",children:"Success Chance"}),e.jsxs("th",{className:"px-4 py-2 text-center",children:["Avg. Attempts",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(mean)"})]}),j&&e.jsxs("th",{className:"px-4 py-2 text-center",children:["Avg. Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]}),e.jsx("th",{className:"px-4 py-2 text-center",children:"Std. Deviation"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"bg-poe-row-even",children:[e.jsxs("td",{className:"px-4 py-3 text-center font-mono",children:[(a.chance*100).toFixed(4),"%"]}),e.jsx("td",{className:"px-4 py-3 text-center font-mono text-poe-highlight",children:a.avgAttempts.toFixed(2)}),j&&e.jsxs("td",{className:"px-4 py-3 text-center font-mono text-poe-gold",children:[(a.avgAttempts*n).toFixed(1),"c"]}),e.jsx("td",{className:"px-4 py-3 text-center font-mono",children:a.stdDev.toFixed(2)})]})})]})}),j&&a&&a.chance>0&&e.jsxs("p",{className:"text-xs text-zinc-400 text-center",children:["Cost per attempt: ",b.toFixed(2),"c (Chromatic) + ",u.toFixed(1),"c (Omen) = ",e.jsxs("strong",{className:"text-zinc-100",children:[n.toFixed(1),"c"]})]})]})}function E(){const{prices:d}=D();return e.jsx("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:e.jsx(B,{prices:d})})}export{E as default};
