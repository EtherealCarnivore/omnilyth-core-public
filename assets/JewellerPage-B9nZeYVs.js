import{r as f,j as e,u as D}from"./index-J4D9V3aS.js";import{c as S}from"./jewellerCalc-Tp4mU2T9.js";import{P as K}from"./PriceDisclaimer-Dehm5mJe.js";import"./colorChances-BUcH6GNe.js";import"./mathUtils-DBoKL8H6.js";function z({prices:p}){const[s,m]=f.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:""}),[u,h]=f.useState(null),[w,b]=f.useState(""),y=p?.["chromatic-orb"]?.chaosRate,k=p?.["jewellers-orb"]?.chaosRate,j=y&&k;function c(t,n){if(t==="sockets"&&n!==""){const l=parseInt(n,10);if(isNaN(l)||l<2||l>6){m(r=>({...r,sockets:""}));return}}if(["red","green","blue"].includes(t)&&n!==""){const l=parseInt(n,10);if(isNaN(l)||l<0){m(r=>({...r,[t]:""}));return}m(r=>{const d=r.sockets===""?6:parseInt(r.sockets,10),x=["red","green","blue"].filter(o=>o!==t).reduce((o,C)=>o+(r[C]===""?0:parseInt(r[C],10)),0),a=Math.min(l,d-x);return a<0?{...r,[t]:""}:{...r,[t]:String(a)}});return}m(l=>({...l,[t]:n}))}function v(){const t=s.str===""?0:parseInt(s.str,10),n=s.dex===""?0:parseInt(s.dex,10),l=s.int===""?0:parseInt(s.int,10),r=s.red===""?0:parseInt(s.red,10),d=s.green===""?0:parseInt(s.green,10),x=s.blue===""?0:parseInt(s.blue,10);let a=s.sockets===""?null:parseInt(s.sockets,10);if(a===null){const o=r+d+x;o>=2&&o<=6&&(a=o,c("sockets",String(o)))}if(!a||a<2||a>6){b("Total sockets must be between 2 and 6."),h(null);return}if(r<0||d<0||x<0){b("Desired colors must be non-negative."),h(null);return}if(r+d+x>a){b(`Desired colors (${r+d+x}) exceed total sockets (${a}).`),h(null);return}b(""),h(S(a,t,n,l,r,d,x))}const N=s.sockets===""?null:parseInt(s.sockets,10),g=s.sockets!==""&&(isNaN(N)||N<2||N>6);function i(t){t.key==="Enter"&&!g&&v()}function I(t){if(!j)return null;const n=t.chromeCost*y+t.jewellerCost*k;return n>=1e3?Math.round(n).toLocaleString()+"c":n.toFixed(1)+"c"}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-amber-300",children:"Jeweller's Method Calculator"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Uses the Crafting Bench to add/remove sockets one at a time, locking in desired colors cheaply. Compares every base-chrome size to find the optimal strategy."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-md mx-auto",children:[e.jsxs("div",{className:"sm:col-span-3 max-w-[120px] mx-auto space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:s.sockets,onChange:t=>c("sockets",t.target.value),onKeyDown:i,className:"calc-input w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"STR"}),e.jsx("input",{type:"number",placeholder:"str",value:s.str,onChange:t=>c("str",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"DEX"}),e.jsx("input",{type:"number",placeholder:"dex",value:s.dex,onChange:t=>c("dex",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"INT"}),e.jsx("input",{type:"number",placeholder:"int",value:s.int,onChange:t=>c("int",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"Red"}),e.jsx("input",{type:"number",placeholder:"R",value:s.red,onChange:t=>c("red",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"Green"}),e.jsx("input",{type:"number",placeholder:"G",value:s.green,onChange:t=>c("green",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"Blue"}),e.jsx("input",{type:"number",placeholder:"B",value:s.blue,onChange:t=>c("blue",t.target.value),onKeyDown:i,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]})]}),g&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 2 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:v,disabled:g,className:"calc-button bg-yellow-900/50 hover:bg-yellow-800/50 border-amber-600/40 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),w&&!g&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:w}),u&&u.length>0&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"px-4 py-2 text-left text-zinc-400 font-medium",children:"Strategy"}),e.jsx("th",{className:"px-4 py-2 text-right text-zinc-400 font-medium",children:"Avg. Chromatics"}),e.jsx("th",{className:"px-4 py-2 text-right text-zinc-400 font-medium",children:"Avg. Jewellers"}),j&&e.jsxs("th",{className:"px-4 py-2 text-right text-zinc-400 font-medium",children:["Total Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]})]})}),e.jsx("tbody",{children:u.map((t,n)=>e.jsxs("tr",{className:t.isBest?"bg-green-900/30 text-green-300":n%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsxs("td",{className:"px-4 py-2 text-left font-medium",children:[t.label,t.isBest&&e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(Best)"})]}),e.jsx("td",{className:"px-4 py-2 text-right font-mono text-poe-highlight",children:t.chromeCost<1e6?t.chromeCost.toFixed(2):t.chromeCost.toExponential(2)}),e.jsx("td",{className:"px-4 py-2 text-right font-mono",children:t.jewellerCost.toFixed(2)}),j&&e.jsx("td",{className:"px-4 py-2 text-right font-mono text-amber-300",children:I(t)})]},n))})]})}),u&&u.length===0&&e.jsx("p",{className:"text-center text-red-400",children:"No valid strategy found."})]})}function J(){const{prices:p}=D();return e.jsxs("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:[e.jsx(K,{}),e.jsx(z,{prices:p})]})}export{J as default};
