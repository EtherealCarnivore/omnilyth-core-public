import{r as I,j as e,u as D}from"./index-J4D9V3aS.js";import{g as z}from"./colorChances-BUcH6GNe.js";import{a as P}from"./mathUtils-DBoKL8H6.js";import{P as S}from"./PriceDisclaimer-Dehm5mJe.js";const K={1:.5,2:.25,3:.25};function B(m,t,f,i,x,y,u,v){const h=z(t,f,i);let r=0;for(let d=1;d<=3;d++){if(d>m||d<v)continue;const k=m-d;if(k<x+y+u)continue;const w=P(k,x,y,u,h.r,h.g,h.b);r+=K[d]*w}const C=r>0?1/r:1/0,a=r>0?Math.sqrt((1-r)/(r*r)):1/0;return{chance:r,avgAttempts:C,stdDev:a}}function F({prices:m}){const[t,f]=I.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:"",white:""}),[i,x]=I.useState(null),[y,u]=I.useState(""),v=m?.["chromatic-orb"]?.chaosRate,h=m?.["omen-of-blanching"]?.chaosValue,r=(v||0)+(h||0),C=v&&h;function a(s,b){if(s==="sockets"&&b!==""){const l=parseInt(b,10);if(isNaN(l)||l<1||l>6){f(n=>({...n,sockets:""}));return}}if(["red","green","blue","white"].includes(s)&&b!==""){const l=parseInt(b,10);if(isNaN(l)||l<0){f(n=>({...n,[s]:""}));return}f(n=>{const g=n.sockets===""?6:parseInt(n.sockets,10),j=["red","green","blue","white"].filter(c=>c!==s).reduce((c,N)=>c+(n[N]===""?0:parseInt(n[N],10)),0);let o=Math.min(l,g-j);return s==="white"&&(o=Math.min(o,3)),o<0?{...n,[s]:""}:{...n,[s]:String(o)}});return}f(l=>({...l,[s]:b}))}function d(){const s=t.str===""?0:parseInt(t.str,10),b=t.dex===""?0:parseInt(t.dex,10),l=t.int===""?0:parseInt(t.int,10),n=t.red===""?0:parseInt(t.red,10),g=t.green===""?0:parseInt(t.green,10),j=t.blue===""?0:parseInt(t.blue,10),o=t.white===""?0:parseInt(t.white,10);let c=t.sockets===""?null:parseInt(t.sockets,10);if(c===null){const N=n+g+j+o;N>0&&N<=6&&(c=N,a("sockets",String(N)))}if(!c||c<1||c>6){u("Total sockets must be between 1 and 6."),x(null);return}if(n<0||g<0||j<0||o<0){u("Desired colors must be non-negative."),x(null);return}if(o<1){u("White sockets (W) must be at least 1 for Omen of Blanching."),x(null);return}if(n+g+j+o>c){u(`Desired colors (${n+g+j+o}) exceed total sockets (${c}).`),x(null);return}u(""),x(B(c,s,b,l,n,g,j,o))}const k=t.sockets===""?null:parseInt(t.sockets,10),w=t.sockets!==""&&(isNaN(k)||k<1||k>6);function p(s){s.key==="Enter"&&!w&&d()}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-sky-300",children:"Omen of Blanching Calculator"}),e.jsxs("p",{className:"text-sm text-zinc-400 mt-1",children:["Uses a normal Chromatic Orb (stat requirements affect colors), then turns ",e.jsx("strong",{className:"text-zinc-100",children:"1â€“3"})," random sockets white (",e.jsx("strong",{className:"text-zinc-100",children:"50% / 25% / 25%"}),")."]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-4 gap-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"sm:col-span-4 max-w-[120px] mx-auto space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:t.sockets,onChange:s=>a("sockets",s.target.value),onKeyDown:p,className:"calc-input w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"STR"}),e.jsx("input",{type:"number",placeholder:"str",value:t.str,onChange:s=>a("str",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"DEX"}),e.jsx("input",{type:"number",placeholder:"dex",value:t.dex,onChange:s=>a("dex",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"INT"}),e.jsx("input",{type:"number",placeholder:"int",value:t.int,onChange:s=>a("int",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]}),e.jsx("div",{}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-red-400",children:"Red"}),e.jsx("input",{type:"number",placeholder:"R",value:t.red,onChange:s=>a("red",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-red border-poe-red-border focus:ring-red-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-green-400",children:"Green"}),e.jsx("input",{type:"number",placeholder:"G",value:t.green,onChange:s=>a("green",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-green border-poe-green-border focus:ring-green-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-blue-400",children:"Blue"}),e.jsx("input",{type:"number",placeholder:"B",value:t.blue,onChange:s=>a("blue",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-center text-gray-300",children:"White"}),e.jsx("input",{type:"number",placeholder:"W",value:t.white,onChange:s=>a("white",s.target.value),onKeyDown:p,className:"calc-input w-full bg-poe-white-socket border-gray-500 focus:ring-gray-400/40"})]})]}),w&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 1 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:d,disabled:w,className:"calc-button bg-zinc-800/60 hover:bg-zinc-800/60 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),y&&!w&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:y}),i&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:i.chance===0?e.jsx("p",{className:"text-center text-red-400 p-4",children:"Impossible with these parameters."}):e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"px-4 py-2 text-center text-zinc-400 font-medium",children:"Success Chance"}),e.jsxs("th",{className:"px-4 py-2 text-center text-zinc-400 font-medium",children:["Avg. Attempts",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(mean)"})]}),C&&e.jsxs("th",{className:"px-4 py-2 text-center text-zinc-400 font-medium",children:["Avg. Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]}),e.jsx("th",{className:"px-4 py-2 text-center text-zinc-400 font-medium",children:"Std. Deviation"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{className:"bg-poe-row-even",children:[e.jsxs("td",{className:"px-4 py-3 text-center font-mono",children:[(i.chance*100).toFixed(4),"%"]}),e.jsx("td",{className:"px-4 py-3 text-center font-mono text-poe-highlight",children:i.avgAttempts.toFixed(2)}),C&&e.jsxs("td",{className:"px-4 py-3 text-center font-mono text-poe-gold",children:[(i.avgAttempts*r).toFixed(1),"c"]}),e.jsx("td",{className:"px-4 py-3 text-center font-mono",children:i.stdDev.toFixed(2)})]})})]})}),C&&i&&i.chance>0&&e.jsx("div",{className:"rounded-xl bg-sky-900/10 border border-sky-800/20 p-4",children:e.jsxs("p",{className:"text-xs text-zinc-400",children:["Cost per attempt: ",v.toFixed(2),"c (Chromatic) + ",h.toFixed(1),"c (Omen) = ",e.jsxs("strong",{className:"text-zinc-100",children:[r.toFixed(1),"c"]})]})})]})}function T(){const{prices:m}=D();return e.jsxs("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:[e.jsx(S,{}),e.jsx(F,{prices:m})]})}export{T as default};
