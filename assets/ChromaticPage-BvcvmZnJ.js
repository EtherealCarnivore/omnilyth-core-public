import{r as z,j as e,u as K}from"./index-Da8jftVc.js";import{g as q}from"./colorChances-BUcH6GNe.js";import{m as F,c as J}from"./mathUtils-DBoKL8H6.js";import{c as L}from"./jewellerCalc-Tp4mU2T9.js";import{P as $}from"./PriceDisclaimer-Dwy1JFb5.js";const W=[{red:0,green:0,blue:0,cost:1,description:"Drop Rate",isDropRate:!0},{red:0,green:0,blue:0,cost:1,description:"Chromatic",isChromatic:!0},{red:1,green:0,blue:0,cost:4,description:"Vorici 1R"},{red:0,green:1,blue:0,cost:4,description:"Vorici 1G"},{red:0,green:0,blue:1,cost:4,description:"Vorici 1B"},{red:2,green:0,blue:0,cost:25,description:"Vorici 2R"},{red:0,green:2,blue:0,cost:25,description:"Vorici 2G"},{red:0,green:0,blue:2,cost:25,description:"Vorici 2B"},{red:0,green:1,blue:1,cost:15,description:"Vorici 1G1B"},{red:1,green:0,blue:1,cost:15,description:"Vorici 1R1B"},{red:1,green:1,blue:0,cost:15,description:"Vorici 1R1G"},{red:3,green:0,blue:0,cost:120,description:"Vorici 3R"},{red:0,green:3,blue:0,cost:120,description:"Vorici 3G"},{red:0,green:0,blue:3,cost:120,description:"Vorici 3B"},{red:2,green:1,blue:0,cost:100,description:"Vorici 2R1G"},{red:2,green:0,blue:1,cost:100,description:"Vorici 2R1B"},{red:1,green:2,blue:0,cost:100,description:"Vorici 1R2G"},{red:0,green:2,blue:1,cost:100,description:"Vorici 2G1B"},{red:1,green:0,blue:2,cost:100,description:"Vorici 1R2B"},{red:0,green:1,blue:2,cost:100,description:"Vorici 1G2B"}];function P(a,s=5,p=!0){if(a===0)return"0."+"0".repeat(s);let m="";a<0&&(a*=-1,m="-");const l=Math.round(a*Math.pow(10,s));l===0&&a>0&&(m=m==="-"?">-":"<");let r=String(l||1);for(;r.length<=s;)r="0"+r;const n=r.slice(0,r.length-s),g=r.slice(r.length-s);if(p){let x="";for(let u=0;u<n.length;u++)u>0&&(n.length-u)%3===0&&(x+=","),x+=n[u];return m+x+"."+g}return m+n+"."+g}function O(a,s,p,m,l,r,n){const g=q(s,p,m),x=a-l-r-n,u=[];for(const o of W){if(o.red>l||o.green>r||o.blue>n)continue;const I=l-o.red,f=r-o.green,B=n-o.blue;let j=F(g,I,f,B,x);if(o.isChromatic){const t=J(g,l,r,n,a);j/=1-t}const C=1/j,y=o.cost*C,A=Math.sqrt(Math.max(1-j,0)/(j*j));u.push({description:o.description,avgCost:o.isDropRate?"-":P(y,1),chance:P(j*100,5,!1)+"%",avgAttempts:P(C,1),costPerTry:o.isDropRate?"-":String(o.cost),stdDev:P(A,2),rawAvgCost:o.isDropRate?1/0:y})}let V=-1,b=1/0;return u.forEach((o,I)=>{o.rawAvgCost>0&&o.rawAvgCost<b&&(b=o.rawAvgCost,V=I)}),V>=0&&(u[V].isBest=!0),u}function X({prices:a}){const[s,p]=z.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:""}),[m,l]=z.useState(null),[r,n]=z.useState(null),[g,x]=z.useState(""),[u,V]=z.useState(!1),b=a?.["chromatic-orb"]?.chaosRate,o=a?.["jewellers-orb"]?.chaosRate,I=b&&o;function f(t,c){if(t==="sockets"&&c!==""){const h=parseInt(c,10);if(isNaN(h)||h<1||h>6){p(i=>({...i,sockets:""}));return}}if(["red","green","blue"].includes(t)&&c!==""){const h=parseInt(c,10);if(isNaN(h)||h<0){p(i=>({...i,[t]:""}));return}p(i=>{const v=i.sockets===""?6:parseInt(i.sockets,10),N=["red","green","blue"].filter(k=>k!==t).reduce((k,T)=>k+(i[T]===""?0:parseInt(i[T],10)),0),d=Math.min(h,v-N);return d<0?{...i,[t]:""}:{...i,[t]:String(d)}});return}p(h=>({...h,[t]:c}))}function B(){const t=s.str===""?0:parseInt(s.str,10),c=s.dex===""?0:parseInt(s.dex,10),h=s.int===""?0:parseInt(s.int,10),i=s.red===""?0:parseInt(s.red,10),v=s.green===""?0:parseInt(s.green,10),N=s.blue===""?0:parseInt(s.blue,10);let d=s.sockets===""?null:parseInt(s.sockets,10);if(d===null&&(d=i+v+N,d>0&&d<=6&&f("sockets",String(d))),!d||d<=0||d>6){x("Total sockets must be between 1 and 6."),l(null),n(null);return}if(t<0||c<0||h<0){x("Invalid stat requirements."),l(null),n(null);return}if(t===0&&c===0&&h===0){x("Please fill in stat requirements."),l(null),n(null);return}if(i<0||v<0||N<0||i+v+N===0||i+v+N>d){x("Invalid desired socket colors."),l(null),n(null);return}x("");const k=O(d,t,c,h,i,v,N);if(l(k),I&&d>=2){const D=L(d,t,c,h,i,v,N).find(w=>w.isBest),S=k.find(w=>w.isBest);if(D&&S&&S.rawAvgCost!==1/0){const w=S.rawAvgCost*b,G=D.chromeCost*b+D.jewellerCost*o;if(G<w){const M=w-G,E=(M/w*100).toFixed(0);n({jewellerChaos:G,voriciChaos:w,saved:M,pctSaved:E,strategy:D.label,bestVoriciName:S.description})}else n(null)}else n(null)}else n(null)}const j=s.sockets===""?null:parseInt(s.sockets,10),C=s.sockets!==""&&(isNaN(j)||j<1||j>6);function y(t){t.key==="Enter"&&!C&&B()}function A(t){if(!b||t===1/0)return"-";const c=t*b;return c>=1e3?Math.round(c).toLocaleString()+"c":c.toFixed(1)+"c"}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-sky-300",children:"Vorici Chromatic Calculator"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Compares Vorici bench crafts vs raw Chromatic Orbs to find the cheapest method."}),e.jsxs("button",{onClick:()=>V(t=>!t),className:"text-xs text-zinc-500 hover:text-zinc-300 transition-colors mt-1.5 flex items-center gap-1",children:[e.jsx("svg",{className:`w-3 h-3 transition-transform duration-200 ${u?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),'Why "Vorici"?']}),u&&e.jsxs("div",{className:"mt-2 rounded-lg bg-zinc-800/40 border border-white/5 p-3 text-xs text-zinc-400 space-y-2 animate-in fade-in",children:[e.jsxs("p",{children:["Back in the old days of PoE, ",e.jsx("strong",{className:"text-zinc-300",children:"Vorici"}),' was a master NPC whose bench was the only way to get guaranteed socket colors. Players discovered that by toggling his "Set Socket Number" crafts up and down, they could force off-colors one socket at a time — locking in good rolls and only re-rolling the newest socket.']}),e.jsxs("p",{children:["Vorici is no longer a master, but the technique lives on at the standard ",e.jsx("strong",{className:"text-zinc-300",children:"Crafting Bench"}),". The community kept calling it ",e.jsx("em",{children:'"The Vorici Method"'})," — a legacy name honoring the guy who first gave exiles the tools to cheat chromatic RNG."]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Total Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:s.sockets,onChange:t=>f("sockets",t.target.value),onKeyDown:y,className:"calc-input w-full"})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsx(R,{label:"STR",placeholder:"str",value:s.str,onChange:t=>f("str",t),onKeyDown:y,variant:"red"}),e.jsx(R,{label:"DEX",placeholder:"dex",value:s.dex,onChange:t=>f("dex",t),onKeyDown:y,variant:"green"}),e.jsx(R,{label:"INT",placeholder:"int",value:s.int,onChange:t=>f("int",t),onKeyDown:y,variant:"blue"}),e.jsx(R,{label:"Red",placeholder:"R",value:s.red,onChange:t=>f("red",t),onKeyDown:y,variant:"red"}),e.jsx(R,{label:"Green",placeholder:"G",value:s.green,onChange:t=>f("green",t),onKeyDown:y,variant:"green"}),e.jsx(R,{label:"Blue",placeholder:"B",value:s.blue,onChange:t=>f("blue",t),onKeyDown:y,variant:"blue"})]}),C&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 1 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:B,disabled:C,className:"calc-button bg-zinc-800/60 hover:bg-zinc-800/60 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),g&&!C&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:g}),r&&e.jsxs("div",{className:"rounded-xl bg-amber-900/20 border border-amber-800/30 p-4 text-sm",children:[e.jsx("p",{className:"text-amber-300 font-semibold mb-1",children:"Jeweller's Method is cheaper!"}),e.jsxs("p",{className:"text-zinc-300",children:["Best chromatic option (",e.jsx("strong",{children:r.bestVoriciName}),") costs ~",e.jsxs("strong",{children:[r.voriciChaos.toFixed(1),"c"]}),", but ",e.jsx("strong",{children:r.strategy})," only costs ~",e.jsxs("strong",{children:[r.jewellerChaos.toFixed(1),"c"]})," — saving you ",e.jsxs("strong",{children:[r.saved.toFixed(1),"c"]})," (",r.pctSaved,"% cheaper)."]}),e.jsx("p",{className:"text-zinc-400 text-xs mt-1",children:"Check the Jeweller's tab for full strategy breakdown."})]}),m&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"px-3 py-2 text-left text-zinc-400 font-medium",children:"Craft Type"}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),b&&e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]}),e.jsx("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:"Success Chance"}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Attempts",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(mean)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Cost/Try",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Std Dev",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(of attempts)"})]})]})}),e.jsx("tbody",{children:m.map((t,c)=>e.jsxs("tr",{className:t.isBest?"bg-green-900/30 text-green-300":c%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsxs("td",{className:"px-3 py-2 text-left font-medium",children:[t.description,t.isBest&&e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(Best)"})]}),e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-highlight",children:t.avgCost}),b&&e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-gold",children:A(t.rawAvgCost)}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.chance}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.avgAttempts}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.costPerTry}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.stdDev})]},c))})]})}),e.jsxs("div",{className:"rounded-xl bg-sky-900/10 border border-sky-800/20 p-4 text-xs text-zinc-400 space-y-1",children:[e.jsx("p",{className:"font-semibold text-zinc-100/80",children:"Chromatic orbs cannot reroll the same color permutation twice, so the chromatic success chance is always higher than the drop rate."}),e.jsx("p",{children:"Mono-req on-color: 0.9 × (R + 10) / (R + 20) • off-color: 0.05 + 4.5 / (R + 20)"}),e.jsx("p",{children:"Dual-req on-color: 0.9 × R1 / (R1 + R2) • off-color: 10% flat"})]})]})}function R({label:a,placeholder:s,value:p,onChange:m,onKeyDown:l,variant:r}){const n={red:"bg-poe-red border-poe-red-border focus:ring-red-500/40",green:"bg-poe-green border-poe-green-border focus:ring-green-500/40",blue:"bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"},g={red:"text-red-400",green:"text-green-400",blue:"text-blue-400"};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:`block text-xs uppercase tracking-wider text-center ${g[r]||"text-zinc-400"}`,children:a}),e.jsx("input",{type:"number",placeholder:s,value:p,onChange:x=>m(x.target.value),onKeyDown:l,className:`calc-input w-full ${n[r]||""}`})]})}function _(){const{prices:a}=K();return e.jsxs("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:[e.jsx($,{}),e.jsx(X,{prices:a})]})}export{_ as default};
