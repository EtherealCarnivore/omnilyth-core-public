import{r as B,j as e,u as G}from"./index-BQTyQAd2.js";import{g as E}from"./colorChances-BUcH6GNe.js";import{m as K,c as M}from"./mathUtils-DBoKL8H6.js";import{c as F}from"./jewellerCalc-Tp4mU2T9.js";const q=[{red:0,green:0,blue:0,cost:1,description:"Drop Rate",isDropRate:!0},{red:0,green:0,blue:0,cost:1,description:"Chromatic",isChromatic:!0},{red:1,green:0,blue:0,cost:4,description:"Vorici 1R"},{red:0,green:1,blue:0,cost:4,description:"Vorici 1G"},{red:0,green:0,blue:1,cost:4,description:"Vorici 1B"},{red:2,green:0,blue:0,cost:25,description:"Vorici 2R"},{red:0,green:2,blue:0,cost:25,description:"Vorici 2G"},{red:0,green:0,blue:2,cost:25,description:"Vorici 2B"},{red:0,green:1,blue:1,cost:15,description:"Vorici 1G1B"},{red:1,green:0,blue:1,cost:15,description:"Vorici 1R1B"},{red:1,green:1,blue:0,cost:15,description:"Vorici 1R1G"},{red:3,green:0,blue:0,cost:120,description:"Vorici 3R"},{red:0,green:3,blue:0,cost:120,description:"Vorici 3G"},{red:0,green:0,blue:3,cost:120,description:"Vorici 3B"},{red:2,green:1,blue:0,cost:100,description:"Vorici 2R1G"},{red:2,green:0,blue:1,cost:100,description:"Vorici 2R1B"},{red:1,green:2,blue:0,cost:100,description:"Vorici 1R2G"},{red:0,green:2,blue:1,cost:100,description:"Vorici 2G1B"},{red:1,green:0,blue:2,cost:100,description:"Vorici 1R2B"},{red:0,green:1,blue:2,cost:100,description:"Vorici 1G2B"}];function z(l,s=5,b=!0){if(l===0)return"0."+"0".repeat(s);let u="";l<0&&(l*=-1,u="-");const i=Math.round(l*Math.pow(10,s));i===0&&l>0&&(u=u==="-"?">-":"<");let n=String(i||1);for(;n.length<=s;)n="0"+n;const o=n.slice(0,n.length-s),p=n.slice(n.length-s);if(b){let x="";for(let c=0;c<o.length;c++)c>0&&(o.length-c)%3===0&&(x+=","),x+=o[c];return u+x+"."+p}return u+o+"."+p}function J(l,s,b,u,i,n,o){const p=E(s,b,u),x=l-i-n-o,c=[];for(const r of q){if(r.red>i||r.green>n||r.blue>o)continue;const j=i-r.red,k=n-r.green,v=o-r.blue;let d=K(p,j,k,v,x);if(r.isChromatic){const m=M(p,i,n,o,l);d/=1-m}const V=1/d,t=r.cost*V,a=Math.sqrt(Math.max(1-d,0)/(d*d));c.push({description:r.description,avgCost:r.isDropRate?"-":z(t,1),chance:z(d*100,5,!1)+"%",avgAttempts:z(V,1),costPerTry:r.isDropRate?"-":String(r.cost),stdDev:z(a,2),rawAvgCost:r.isDropRate?1/0:t})}let f=-1,R=1/0;return c.forEach((r,j)=>{r.rawAvgCost>0&&r.rawAvgCost<R&&(R=r.rawAvgCost,f=j)}),f>=0&&(c[f].isBest=!0),c}function $({prices:l}){const[s,b]=B.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:""}),[u,i]=B.useState(null),[n,o]=B.useState(null),[p,x]=B.useState(""),c=l?.["chromatic-orb"]?.chaosRate,f=l?.["jewellers-orb"]?.chaosRate,R=c&&f;function r(t,a){b(m=>({...m,[t]:a}))}function j(){const t=s.str===""?0:parseInt(s.str,10),a=s.dex===""?0:parseInt(s.dex,10),m=s.int===""?0:parseInt(s.int,10),y=s.red===""?0:parseInt(s.red,10),C=s.green===""?0:parseInt(s.green,10),N=s.blue===""?0:parseInt(s.blue,10);let h=s.sockets===""?null:parseInt(s.sockets,10);if(h===null&&(h=y+C+N,h>0&&h<=6&&r("sockets",String(h))),!h||h<=0||h>6){x("Total sockets must be between 1 and 6."),i(null),o(null);return}if(t<0||a<0||m<0){x("Invalid stat requirements."),i(null),o(null);return}if(t===0&&a===0&&m===0){x("Please fill in stat requirements."),i(null),o(null);return}if(y<0||C<0||N<0||y+C+N===0||y+C+N>h){x("Invalid desired socket colors."),i(null),o(null);return}x("");const A=J(h,t,a,m,y,C,N);if(i(A),R&&h>=2){const I=F(h,t,a,m,y,C,N).find(g=>g.isBest),D=A.find(g=>g.isBest);if(I&&D&&D.rawAvgCost!==1/0){const g=D.rawAvgCost*c,S=I.chromeCost*c+I.jewellerCost*f;if(S<g){const P=g-S,T=(P/g*100).toFixed(0);o({jewellerChaos:S,voriciChaos:g,saved:P,pctSaved:T,strategy:I.label,bestVoriciName:D.description})}else o(null)}else o(null)}else o(null)}const k=s.sockets===""?null:parseInt(s.sockets,10),v=s.sockets!==""&&(isNaN(k)||k<1||k>6);function d(t){t.key==="Enter"&&!v&&j()}function V(t){if(!c||t===1/0)return"-";const a=t*c;return a>=1e3?Math.round(a).toLocaleString()+"c":a.toFixed(1)+"c"}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-sky-300",children:"Vorici Chromatic Calculator"}),e.jsx("p",{className:"text-sm text-zinc-400 mt-1",children:"Compares Vorici bench crafts vs raw Chromatic Orbs to find the cheapest method."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Total Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:s.sockets,onChange:t=>r("sockets",t.target.value),onKeyDown:d,className:"calc-input w-full"})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsx(w,{label:"STR",placeholder:"str",value:s.str,onChange:t=>r("str",t),onKeyDown:d,variant:"red"}),e.jsx(w,{label:"DEX",placeholder:"dex",value:s.dex,onChange:t=>r("dex",t),onKeyDown:d,variant:"green"}),e.jsx(w,{label:"INT",placeholder:"int",value:s.int,onChange:t=>r("int",t),onKeyDown:d,variant:"blue"}),e.jsx(w,{label:"Red",placeholder:"R",value:s.red,onChange:t=>r("red",t),onKeyDown:d,variant:"red"}),e.jsx(w,{label:"Green",placeholder:"G",value:s.green,onChange:t=>r("green",t),onKeyDown:d,variant:"green"}),e.jsx(w,{label:"Blue",placeholder:"B",value:s.blue,onChange:t=>r("blue",t),onKeyDown:d,variant:"blue"})]}),v&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 1 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:j,disabled:v,className:"calc-button bg-zinc-800/60 hover:bg-zinc-800/60 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),p&&!v&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:p}),n&&e.jsxs("div",{className:"rounded-xl bg-amber-900/20 border border-amber-800/30 p-4 text-sm",children:[e.jsx("p",{className:"text-amber-300 font-semibold mb-1",children:"Jeweller's Method is cheaper!"}),e.jsxs("p",{className:"text-zinc-300",children:["Best chromatic option (",e.jsx("strong",{children:n.bestVoriciName}),") costs ~",e.jsxs("strong",{children:[n.voriciChaos.toFixed(1),"c"]}),", but ",e.jsx("strong",{children:n.strategy})," only costs ~",e.jsxs("strong",{children:[n.jewellerChaos.toFixed(1),"c"]})," — saving you ",e.jsxs("strong",{children:[n.saved.toFixed(1),"c"]})," (",n.pctSaved,"% cheaper)."]}),e.jsx("p",{className:"text-zinc-400 text-xs mt-1",children:"Check the Jeweller's tab for full strategy breakdown."})]}),u&&e.jsx("div",{className:"overflow-x-auto rounded-lg border border-white/5",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/5",children:[e.jsx("th",{className:"px-3 py-2 text-left text-zinc-400 font-medium",children:"Craft Type"}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),c&&e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]}),e.jsx("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:"Success Chance"}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Avg Attempts",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(mean)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Cost/Try",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right text-zinc-400 font-medium",children:["Std Dev",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(of attempts)"})]})]})}),e.jsx("tbody",{children:u.map((t,a)=>e.jsxs("tr",{className:t.isBest?"bg-green-900/30 text-green-300":a%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsxs("td",{className:"px-3 py-2 text-left font-medium",children:[t.description,t.isBest&&e.jsx("span",{className:"ml-2 text-xs text-green-400",children:"(Best)"})]}),e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-highlight",children:t.avgCost}),c&&e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-gold",children:V(t.rawAvgCost)}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.chance}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.avgAttempts}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.costPerTry}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.stdDev})]},a))})]})}),e.jsxs("div",{className:"rounded-xl bg-sky-900/10 border border-sky-800/20 p-4 text-xs text-zinc-400 space-y-1",children:[e.jsx("p",{className:"font-semibold text-zinc-100/80",children:"Chromatic orbs cannot reroll the same color permutation twice, so the chromatic success chance is always higher than the drop rate."}),e.jsx("p",{children:"Mono-req on-color: 0.9 × (R + 10) / (R + 20) • off-color: 0.05 + 4.5 / (R + 20)"}),e.jsx("p",{children:"Dual-req on-color: 0.9 × R1 / (R1 + R2) • off-color: 10% flat"})]})]})}function w({label:l,placeholder:s,value:b,onChange:u,onKeyDown:i,variant:n}){const o={red:"bg-poe-red border-poe-red-border focus:ring-red-500/40",green:"bg-poe-green border-poe-green-border focus:ring-green-500/40",blue:"bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"},p={red:"text-red-400",green:"text-green-400",blue:"text-blue-400"};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:`block text-xs uppercase tracking-wider text-center ${p[n]||"text-zinc-400"}`,children:l}),e.jsx("input",{type:"number",placeholder:s,value:b,onChange:x=>u(x.target.value),onKeyDown:i,className:`calc-input w-full ${o[n]||""}`})]})}function U(){const{prices:l}=G();return e.jsx("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:e.jsx($,{prices:l})})}export{U as default};
