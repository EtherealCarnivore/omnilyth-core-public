import{r as B,j as e,u as G}from"./index-StS4Kiu4.js";import{g as E}from"./colorChances-BUcH6GNe.js";import{m as K,c as M}from"./mathUtils-DBoKL8H6.js";import{c as F}from"./jewellerCalc-Tp4mU2T9.js";const q=[{red:0,green:0,blue:0,cost:1,description:"Drop Rate",isDropRate:!0},{red:0,green:0,blue:0,cost:1,description:"Chromatic",isChromatic:!0},{red:1,green:0,blue:0,cost:4,description:"Vorici 1R"},{red:0,green:1,blue:0,cost:4,description:"Vorici 1G"},{red:0,green:0,blue:1,cost:4,description:"Vorici 1B"},{red:2,green:0,blue:0,cost:25,description:"Vorici 2R"},{red:0,green:2,blue:0,cost:25,description:"Vorici 2G"},{red:0,green:0,blue:2,cost:25,description:"Vorici 2B"},{red:0,green:1,blue:1,cost:15,description:"Vorici 1G1B"},{red:1,green:0,blue:1,cost:15,description:"Vorici 1R1B"},{red:1,green:1,blue:0,cost:15,description:"Vorici 1R1G"},{red:3,green:0,blue:0,cost:120,description:"Vorici 3R"},{red:0,green:3,blue:0,cost:120,description:"Vorici 3G"},{red:0,green:0,blue:3,cost:120,description:"Vorici 3B"},{red:2,green:1,blue:0,cost:100,description:"Vorici 2R1G"},{red:2,green:0,blue:1,cost:100,description:"Vorici 2R1B"},{red:1,green:2,blue:0,cost:100,description:"Vorici 1R2G"},{red:0,green:2,blue:1,cost:100,description:"Vorici 2G1B"},{red:1,green:0,blue:2,cost:100,description:"Vorici 1R2B"},{red:0,green:1,blue:2,cost:100,description:"Vorici 1G2B"}];function S(l,s=5,b=!0){if(l===0)return"0."+"0".repeat(s);let p="";l<0&&(l*=-1,p="-");const a=Math.round(l*Math.pow(10,s));a===0&&l>0&&(p=p==="-"?">-":"<");let o=String(a||1);for(;o.length<=s;)o="0"+o;const n=o.slice(0,o.length-s),h=o.slice(o.length-s);if(b){let x="";for(let c=0;c<n.length;c++)c>0&&(n.length-c)%3===0&&(x+=","),x+=n[c];return p+x+"."+h}return p+n+"."+h}function J(l,s,b,p,a,o,n){const h=E(s,b,p),x=l-a-o-n,c=[];for(const r of q){if(r.red>a||r.green>o||r.blue>n)continue;const j=a-r.red,k=o-r.green,v=n-r.blue;let d=K(h,j,k,v,x);if(r.isChromatic){const m=M(h,a,o,n,l);d/=1-m}const V=1/d,t=r.cost*V,i=Math.sqrt(Math.max(1-d,0)/(d*d));c.push({description:r.description,avgCost:r.isDropRate?"-":S(t,1),chance:S(d*100,5,!1)+"%",avgAttempts:S(V,1),costPerTry:r.isDropRate?"-":String(r.cost),stdDev:S(i,2),rawAvgCost:r.isDropRate?1/0:t})}let f=-1,R=1/0;return c.forEach((r,j)=>{r.rawAvgCost>0&&r.rawAvgCost<R&&(R=r.rawAvgCost,f=j)}),f>=0&&(c[f].isBest=!0),c}function $({prices:l}){const[s,b]=B.useState({sockets:"",str:"",dex:"",int:"",red:"",green:"",blue:""}),[p,a]=B.useState(null),[o,n]=B.useState(null),[h,x]=B.useState(""),c=l?.["chromatic-orb"]?.chaosRate,f=l?.["jewellers-orb"]?.chaosRate,R=c&&f;function r(t,i){b(m=>({...m,[t]:i}))}function j(){const t=s.str===""?0:parseInt(s.str,10),i=s.dex===""?0:parseInt(s.dex,10),m=s.int===""?0:parseInt(s.int,10),y=s.red===""?0:parseInt(s.red,10),C=s.green===""?0:parseInt(s.green,10),N=s.blue===""?0:parseInt(s.blue,10);let u=s.sockets===""?null:parseInt(s.sockets,10);if(u===null&&(u=y+C+N,u>0&&u<=6&&r("sockets",String(u))),!u||u<=0||u>6){x("Total sockets must be between 1 and 6."),a(null),n(null);return}if(t<0||i<0||m<0){x("Invalid stat requirements."),a(null),n(null);return}if(t===0&&i===0&&m===0){x("Please fill in stat requirements."),a(null),n(null);return}if(y<0||C<0||N<0||y+C+N===0||y+C+N>u){x("Invalid desired socket colors."),a(null),n(null);return}x("");const P=J(u,t,i,m,y,C,N);if(a(P),R&&u>=2){const I=F(u,t,i,m,y,C,N).find(g=>g.isBest),D=P.find(g=>g.isBest);if(I&&D&&D.rawAvgCost!==1/0){const g=D.rawAvgCost*c,A=I.chromeCost*c+I.jewellerCost*f;if(A<g){const z=g-A,T=(z/g*100).toFixed(0);n({jewellerChaos:A,voriciChaos:g,saved:z,pctSaved:T,strategy:I.label,bestVoriciName:D.description})}else n(null)}else n(null)}else n(null)}const k=s.sockets===""?null:parseInt(s.sockets,10),v=s.sockets!==""&&(isNaN(k)||k<1||k>6);function d(t){t.key==="Enter"&&!v&&j()}function V(t){if(!c||t===1/0)return"-";const i=t*c;return i>=1e3?Math.round(i).toLocaleString()+"c":i.toFixed(1)+"c"}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsxs("h2",{className:"text-2xl font-bold text-zinc-100 flex items-center justify-center gap-3",children:[e.jsx("img",{src:"/omnilyth-core-public/Chromatic_Orb.png",alt:"",className:"w-8 h-8"}),"Vorici Chromatic Calculator"]}),e.jsx("p",{className:"text-sm text-zinc-400",children:"Compares Vorici bench crafts vs raw Chromatic Orbs to find the cheapest method."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-lg mx-auto",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-xs uppercase tracking-wider text-zinc-400 text-center",children:"Total Sockets"}),e.jsx("input",{type:"number",placeholder:"#",value:s.sockets,onChange:t=>r("sockets",t.target.value),onKeyDown:d,className:"calc-input w-full"})]}),e.jsx("div",{}),e.jsx("div",{}),e.jsx(w,{label:"STR",placeholder:"str",value:s.str,onChange:t=>r("str",t),onKeyDown:d,variant:"red"}),e.jsx(w,{label:"DEX",placeholder:"dex",value:s.dex,onChange:t=>r("dex",t),onKeyDown:d,variant:"green"}),e.jsx(w,{label:"INT",placeholder:"int",value:s.int,onChange:t=>r("int",t),onKeyDown:d,variant:"blue"}),e.jsx(w,{label:"Red",placeholder:"R",value:s.red,onChange:t=>r("red",t),onKeyDown:d,variant:"red"}),e.jsx(w,{label:"Green",placeholder:"G",value:s.green,onChange:t=>r("green",t),onKeyDown:d,variant:"green"}),e.jsx(w,{label:"Blue",placeholder:"B",value:s.blue,onChange:t=>r("blue",t),onKeyDown:d,variant:"blue"})]}),v&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:"Total sockets must be between 1 and 6."}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:j,disabled:v,className:"calc-button bg-zinc-800/60 hover:bg-zinc-800/60 disabled:opacity-40 disabled:cursor-not-allowed disabled:hover:transform-none",children:"Calculate"})}),h&&!v&&e.jsx("p",{className:"text-center text-red-400 text-sm",children:h}),o&&e.jsxs("div",{className:"rounded-lg border border-poe-gold/40 bg-poe-jeweller-best-even/60 px-4 py-3 text-sm",children:[e.jsx("p",{className:"text-poe-gold font-semibold mb-1",children:"Jeweller's Method is cheaper!"}),e.jsxs("p",{className:"text-poe-jeweller-best-text",children:["Best chromatic option (",e.jsx("strong",{children:o.bestVoriciName}),") costs ~",e.jsxs("strong",{children:[o.voriciChaos.toFixed(1),"c"]}),", but ",e.jsx("strong",{children:o.strategy})," only costs ~",e.jsxs("strong",{children:[o.jewellerChaos.toFixed(1),"c"]})," — saving you ",e.jsxs("strong",{children:[o.saved.toFixed(1),"c"]})," (",o.pctSaved,"% cheaper)."]}),e.jsx("p",{className:"text-zinc-400 text-xs mt-1",children:"Check the Jeweller's tab for full strategy breakdown."})]}),p&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-zinc-400 text-xs uppercase tracking-wider",children:[e.jsx("th",{className:"px-3 py-2 text-left",children:"Craft Type"}),e.jsxs("th",{className:"px-3 py-2 text-right",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),c&&e.jsxs("th",{className:"px-3 py-2 text-right",children:["Avg Cost",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chaos)"})]}),e.jsx("th",{className:"px-3 py-2 text-right",children:"Success Chance"}),e.jsxs("th",{className:"px-3 py-2 text-right",children:["Avg Attempts",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(mean)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right",children:["Cost/Try",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(in chromatics)"})]}),e.jsxs("th",{className:"px-3 py-2 text-right",children:["Std Dev",e.jsx("span",{className:"block text-[10px] normal-case tracking-normal opacity-60",children:"(of attempts)"})]})]})}),e.jsx("tbody",{children:p.map((t,i)=>e.jsxs("tr",{className:t.isBest?"bg-poe-best-even text-poe-best-text border-l-2 border-r-2 border-green-700":i%2===0?"bg-poe-row-even":"bg-poe-row-odd",children:[e.jsx("td",{className:"px-3 py-2 text-left font-medium",children:t.description}),e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-highlight",children:t.avgCost}),c&&e.jsx("td",{className:"px-3 py-2 text-right font-mono text-poe-gold",children:V(t.rawAvgCost)}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.chance}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.avgAttempts}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.costPerTry}),e.jsx("td",{className:"px-3 py-2 text-right font-mono",children:t.stdDev})]},i))})]})}),e.jsxs("div",{className:"text-xs text-zinc-400 text-center space-y-1 pt-2 border-t border-white/5",children:[e.jsx("p",{className:"font-semibold text-zinc-100/80",children:"Chromatic orbs cannot reroll the same color permutation twice, so the chromatic success chance is always higher than the drop rate."}),e.jsx("p",{children:"Mono-req on-color: 0.9 × (R + 10) / (R + 20) • off-color: 0.05 + 4.5 / (R + 20)"}),e.jsx("p",{children:"Dual-req on-color: 0.9 × R1 / (R1 + R2) • off-color: 10% flat"})]})]})}function w({label:l,placeholder:s,value:b,onChange:p,onKeyDown:a,variant:o}){const n={red:"bg-poe-red border-poe-red-border focus:ring-red-500/40",green:"bg-poe-green border-poe-green-border focus:ring-green-500/40",blue:"bg-poe-blue border-poe-blue-border focus:ring-blue-500/40"},h={red:"text-red-400",green:"text-green-400",blue:"text-blue-400"};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:`block text-xs uppercase tracking-wider text-center ${h[o]||"text-zinc-400"}`,children:l}),e.jsx("input",{type:"number",placeholder:s,value:b,onChange:x=>p(x.target.value),onKeyDown:a,className:`calc-input w-full ${n[o]||""}`})]})}function Q(){const{prices:l}=G();return e.jsx("div",{className:"glass-card rounded-2xl p-6 sm:p-8",children:e.jsx($,{prices:l})})}export{Q as default};
